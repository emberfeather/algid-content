(function(b){function j(c,a){var d,e,f;if(c.ctrlKey==true){d=b(a.item[0]).clone(true);e=d.data("previousIndex");f=b(a.sender[0]);e==0?f.prepend(d):b("li:eq("+(e-1)+")",f).after(d)}}function k(c,a){var d=b(a);d.data("original",d.text())}function l(c){c=b(c.target);b.api({plugin:"content",service:"path",action:"renamePath"},{title:c.val(),pathID:c.parents("[data-pathID]").attr("data-pathID")},{success:function(a){a.HEAD.result||window.console.error(a.HEAD.errors)}})}function m(){var c=[];g.each(function(){var a;
a=b(this);var d={navigationID:a.attr("data-navigationID"),paths:a.sortable("toArray")};for(a=0;a<d.paths.length;a++)d.paths[a]=d.paths[a].substr(5);c.push(d)});b.api({plugin:"content",service:"navigation",action:"setPositions"},{path:h.val(),positions:c},{success:function(a){if(!a.HEAD.result){b(".content").after(b("<div />",{html:a.HEAD.errors.HEAD.error.detail}));b(".content").after(b("<div />",{html:a.HEAD.errors.HEAD.error.stacktrace}));window.console.error(a.HEAD.errors)}}});i()}function i(){g.each(function(){b("li",
this).each(function(c){b(this).data("previousIndex",c)})})}var g,h;b(function(){var c={};g=b(".sortable");h=b("#path");i();g.each(function(){b(this).sortable({connectWith:g,update:m,receive:j})});b(".title",g).each(k).change(l);h.autocomplete({select:function(){h.parent().trigger("submit")},source:function(a,d){a.term in c?d(c[a.term]):b.api({plugin:"content",service:"path",action:"searchPath"},{path:a.term},{success:function(e){if(e.HEAD.result){for(var f=0;f<e.BODY.length;f++){e.BODY[f].value=e.BODY[f].path;
e.BODY[f].label=e.BODY[f].path}c[a.term]=e.BODY;d(e.BODY)}else{window.console.error&&window.console.error(e.HEAD.errors);d([])}}})},minLength:1})})})(jQuery);
